# Data Model: Bronze Tier AI Employee

**Phase**: 1 - Design & Contracts
**Date**: 2026-02-12
**Purpose**: Define data structures and relationships for Bronze Tier entities

## Overview

Bronze Tier uses a file-based data model where all entities are represented as Markdown files with YAML frontmatter. Folder location represents entity state, eliminating the need for a database.

---

## Entity: Task File

**Purpose**: Represents a work item requiring action

**Location**: Moves through folders based on lifecycle stage
- Created in: `/Inbox`
- Triaged to: `/Needs_Action`
- Archived in: `/Done`

**File Format**: Markdown with YAML frontmatter

**Frontmatter Schema**:

```yaml
---
id: string              # Unique identifier (e.g., "task-001")
title: string           # Human-readable task title
status: enum            # Current status: "inbox" | "needs_action" | "done"
created: date           # ISO 8601 date (YYYY-MM-DD)
updated: date           # ISO 8601 date (YYYY-MM-DD)
completed: date?        # ISO 8601 date (YYYY-MM-DD) - only when status="done"
tags: string[]?         # Optional tags for categorization
priority: enum?         # Optional: "high" | "medium" | "low"
---
```

**Content Body**: Free-form Markdown describing the task requirements

**Example**:

```markdown
---
id: task-001
title: Research Bronze Tier architecture options
status: needs_action
created: 2026-02-12
updated: 2026-02-12
tags: [research, architecture]
priority: high
---

# Task Description

Research and document the architectural options for implementing Bronze Tier AI Employee system.

## Requirements

- Must operate entirely locally
- No external APIs
- File-based state management

## Deliverables

- Architecture decision document
- Technology stack recommendations
```

**Validation Rules**:
- `id` must be unique across all folders
- `status` must match folder location (enforced by folder-based state)
- `created` date is immutable
- `updated` date changes on any modification
- `completed` date only set when moved to `/Done`

**State Transitions**:
- `inbox` → `needs_action`: Watcher moves file from `/Inbox` to `/Needs_Action`
- `needs_action` → `done`: Claude CLI moves file to `/Done` and sets `completed` date

---

## Entity: Plan File

**Purpose**: Structured execution plan generated by Claude from a task

**Location**: `/Plans` folder

**File Format**: Markdown with YAML frontmatter

**Frontmatter Schema**:

```yaml
---
id: string              # Unique identifier (e.g., "plan-001")
task_id: string         # Reference to source task (e.g., "task-001")
title: string           # Plan title (usually matches task title)
created: date           # ISO 8601 date (YYYY-MM-DD)
updated: date           # ISO 8601 date (YYYY-MM-DD)
status: enum            # "draft" | "approved" | "completed"
---
```

**Content Body Structure**:

```markdown
## Goal

[Clear statement of what this plan achieves]

## Steps

1. [First step with acceptance criteria]
2. [Second step with acceptance criteria]
3. [Third step with acceptance criteria]

## Acceptance Criteria

- [ ] Criterion 1
- [ ] Criterion 2
- [ ] Criterion 3

## Questions

[Optional section for clarifications needed]

## Notes

[Optional section for additional context]
```

**Example**:

```markdown
---
id: plan-001
task_id: task-001
title: Research Bronze Tier architecture options
created: 2026-02-12
updated: 2026-02-12
status: draft
---

## Goal

Document architectural options for Bronze Tier AI Employee with technology recommendations.

## Steps

1. Research file system watcher libraries (Python watchdog, Node.js chokidar)
2. Evaluate YAML frontmatter parsing options
3. Design folder-based state management approach
4. Document technology stack with rationale

## Acceptance Criteria

- [ ] At least 3 watcher options evaluated
- [ ] Frontmatter parsing approach selected
- [ ] State transition diagram created
- [ ] Technology stack documented with justification

## Questions

None at this time.

## Notes

Focus on cross-platform solutions to enable future macOS/Linux support.
```

**Validation Rules**:
- `task_id` should reference an existing task (soft constraint, not enforced)
- Plan files remain in `/Plans` until associated task is completed
- When task moves to `/Done`, plan can optionally move with it

**Relationship to Task**:
- One task may have zero or one plan
- Plan is generated by Claude CLI based on task content
- Plan and task share same base identifier (task-001 → plan-001)

---

## Entity: Dashboard

**Purpose**: Central status file showing system state and recent activity

**Location**: `/Dashboard.md` (vault root)

**File Format**: Markdown (no frontmatter needed)

**Content Structure**:

```markdown
# Dashboard

**Last Updated**: [ISO 8601 timestamp]

## Task Counts

- **Inbox**: [count] tasks
- **Needs Action**: [count] tasks
- **Plans**: [count] plans
- **Done**: [count] completed

## Recent Activity

[Last 10 state changes, newest first]

1. [timestamp] - [action] - [file]
2. [timestamp] - [action] - [file]
...

## System Status

- **Watcher**: [running | stopped]
- **Last Watcher Event**: [timestamp]
- **Vault Path**: E:\AI_Employee_Vault
```

**Example**:

```markdown
# Dashboard

**Last Updated**: 2026-02-12T14:30:00

## Task Counts

- **Inbox**: 0 tasks
- **Needs Action**: 3 tasks
- **Plans**: 2 plans
- **Done**: 15 completed

## Recent Activity

1. 2026-02-12T14:25:00 - Moved to Done - task-015.md
2. 2026-02-12T14:20:00 - Plan created - plan-014.md
3. 2026-02-12T14:15:00 - Moved to Needs_Action - task-016.md
4. 2026-02-12T14:10:00 - Moved to Needs_Action - task-017.md
5. 2026-02-12T14:05:00 - Moved to Done - task-013.md

## System Status

- **Watcher**: running
- **Last Watcher Event**: 2026-02-12T14:15:00
- **Vault Path**: E:\AI_Employee_Vault
```

**Update Strategy**:
- Regenerated on-demand by scanning folders
- Claude CLI can update after task operations
- Watcher can update after file moves (optional)

**Validation Rules**:
- Counts must match actual folder contents
- Recent activity limited to last 10 entries
- Timestamps in ISO 8601 format

---

## Entity: Company Handbook

**Purpose**: Reference document containing project context and guidelines for AI task interpretation

**Location**: `/Company_Handbook.md` (vault root)

**File Format**: Markdown (no frontmatter needed)

**Content Structure**:

```markdown
# Company Handbook

## Project Context

[Description of the project, goals, and principles]

## Task Guidelines

[How to interpret and process tasks]

## Quality Standards

[Acceptance criteria for completed work]

## Communication Style

[Tone and format preferences]

## References

[Links to constitution, specs, and other resources]
```

**Example**:

```markdown
# Company Handbook

## Project Context

This is the Bronze Tier AI Employee project, a minimal local AI assistant that manages tasks through an Obsidian vault using folder-based state management.

## Task Guidelines

When processing tasks:
- Read task description carefully
- Generate structured plans with clear steps
- Include acceptance criteria for verification
- Ask clarifying questions if requirements are ambiguous

## Quality Standards

All plans must include:
- Clear goal statement
- Numbered steps with acceptance criteria
- Testable outcomes
- No implementation details (focus on WHAT, not HOW)

## Communication Style

- Be concise and actionable
- Use bullet points for clarity
- Include examples when helpful
- Avoid jargon unless necessary

## References

- Constitution: `.specify/memory/constitution.md`
- Specification: `specs/001-bronze-tier/spec.md`
- Implementation Plan: `specs/001-bronze-tier/plan.md`
```

**Update Strategy**:
- Manually maintained by user
- Updated when project principles or guidelines change
- Claude reads this file for context when processing tasks

---

## Folder State Model

**State Representation**: Physical folder location is the single source of truth

**State Transitions**:

```
┌─────────┐
│  Inbox  │ (New tasks dropped here)
└────┬────┘
     │ Watcher detects and moves
     ▼
┌──────────────┐
│ Needs_Action │ (Tasks ready for AI processing)
└──────┬───────┘
       │ Claude generates plan (task stays here)
       │ User completes work
       │ Claude marks complete
       ▼
┌──────────┐
│   Done   │ (Completed tasks archived)
└──────────┘

┌────────┐
│ Plans  │ (Generated plans, parallel to tasks)
└────────┘
```

**State Invariants**:
- A file can only exist in one folder at a time
- Folder location determines status (no separate status database)
- File moves are atomic (no partial states)
- Plans folder is independent (plans don't transition through states)

---

## File Naming Conventions

**Task Files**: `task-NNN.md` where NNN is zero-padded number (e.g., `task-001.md`)

**Plan Files**: `plan-NNN.md` where NNN matches the task number (e.g., `plan-001.md`)

**Collision Handling**: Append ISO 8601 timestamp if name exists
- Example: `task-001-20260212T143000.md`

**Special Files**:
- `Dashboard.md` - System status (vault root)
- `Company_Handbook.md` - Project context (vault root)

---

## Data Integrity

**Consistency Rules**:
- Task `status` field should match folder location (soft constraint)
- Plan `task_id` should reference existing task (soft constraint)
- Dashboard counts should match folder contents (regenerated on-demand)

**Backup Strategy**:
- User responsible for vault backups (git recommended)
- No automated backup in Bronze Tier
- All data is plain text (easy to recover)

**Error Handling**:
- Malformed YAML: Log warning, process as plain markdown
- Missing frontmatter: Create minimal frontmatter on first edit
- Corrupted files: Move to error folder (future enhancement)

---

## Relationships

```
Task (1) ──── (0..1) Plan
  │
  └─ Located in: Inbox | Needs_Action | Done

Plan
  └─ Located in: Plans (static)

Dashboard
  └─ Aggregates: All folders

Company_Handbook
  └─ Referenced by: Claude when processing tasks
```

---

## Schema Evolution

**Versioning**: Frontmatter schema version tracked in constitution

**Migration Strategy**:
- Additive changes only (new optional fields)
- No breaking changes in Bronze Tier
- Scripts to migrate frontmatter if needed (future)

**Backward Compatibility**:
- Old files without new fields remain valid
- New fields have sensible defaults
- No forced migrations
